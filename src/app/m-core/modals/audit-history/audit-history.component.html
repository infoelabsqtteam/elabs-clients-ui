<div mdbModal #auditHistory="mdbModal" class="modal fade">
  <div class="modal-dialog modal-dialog-scrollable modal-dialog-full-width" role="document">
    <div class="modal-content">
      <div class="modal-header justify-content-center m-0">
        <h4 class="modal-title font-weight-bold m-0">Audit History</h4>
        <button class="closebtb" (click)="close()"><span>&times;</span></button>
      </div>

      <div class="d-flex align-items-center justify-content-center bg-light px-3 py-2">
        <h4 class="m-0" *ngIf="selectedTab">{{selectedTab.label}}</h4>
        <div class="d-flex align-items-center mx-3" *ngIf="allVersionList && allVersionList.length > 0">
          <select (change)="changeAuditVersion($event.target.value)">
            <option *ngFor="let data of allVersionList; let i = index" [value]="data">{{data}}
            </option>
          </select>
        </div>
        <div class="mt-2"><mat-checkbox color="primary">Show Difference</mat-checkbox></div>
      </div>

      <div class="modal-body auditdetails">
        <table class="table" *ngIf="formFields && formFields.length > 0">
          <thead class="thead-light">
            <tr>
              <th scope="col">Form Fields</th>
              <th scope="col">Old Data</th>
              <th scope="col">Current Data</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let field of formFields" [ngClass]="field && field.isChanged ? 'bg-danger':'nochange'">

              <td>
                <ng-container *ngIf="field.datatype != 'list_of_object'">
                  <strong>{{field.label | titlecase}}</strong>
                </ng-container>
                <ng-container *ngIf="field.datatype == 'list_of_object'">
                  <strong>{{field.label | titlecase}}</strong>
                  <p *ngFor="let data of field.list_of_fields">{{data.label}}</p>
                </ng-container>
              </td>

              <td *ngIf="previousObject != null && field && field.field_name">
                  <ng-container *ngIf="field.datatype == 'object' && field.datatype != 'list_of_object'">
                    {{previousObject[field.field_name].name}}
                  </ng-container>
                  <ng-container *ngIf="field.datatype != 'object' && field.datatype != 'list_of_object' && field.type != 'grid_selection'">
                    {{previousObject[field.field_name]}}
                  </ng-container>
                  <ng-container *ngIf="field.datatype == 'list_of_object'">
                      <p *ngFor="let data of field.list_of_fields">{{previousObject[data.field_name]}}</p>
                  </ng-container>
                  <ng-container *ngIf="field.type == 'grid_selection'">
                    <span>{{field.fields.length}}</span>
                    <!-- <mat-icon (click)="showGridSelection(field, previousObject[field.field_name])">visibility</mat-icon> -->
                </ng-container>
              </td>

              <td *ngIf="currentObject != null && field && field.field_name">
                  <ng-container *ngIf="field.datatype == 'object' && field.datatype != 'list_of_object'">
                    {{currentObject[field.field_name].name}}
                  </ng-container>
                  <ng-container *ngIf="field.datatype != 'object' && field.datatype != 'list_of_object' && field.type != 'grid_selection'">
                    {{currentObject[field.field_name]}}
                  </ng-container>
                  <ng-container *ngIf="field.datatype == 'list_of_object'">
                      <p *ngFor="let data of field.list_of_fields">{{currentObject[data.field_name]}}</p>
                  </ng-container>
                  <ng-container *ngIf="field.type == 'grid_selection'">
                    <span>{{field.fields.length}}</span>
                    <!-- <mat-icon (click)="showGridSelection(field, currentObject[field.field_name])">visibility</mat-icon> -->
                </ng-container>
              </td>


              <!-- <td class="p-0" colspan="3" *ngIf="field.type == 'grid_selection'">
                <mat-accordion>
                  <mat-expansion-panel>
                    <mat-expansion-panel-header>{{field.label}}</mat-expansion-panel-header>
                      <table *ngIf="(currentObject[field.field_name] && currentObject[field.field_name].length > 0 ) || (previousObject[field.field_name] && previousObject[field.field_name].length > 0 )">
                        <ng-container *ngFor="let gridCurrentData of currentObject[field.field_name]; index as i">
                          
                          <ng-container *ngFor="let gridLastData of previousObject[field.field_name]; index as i">
                          <tr *ngFor="let childfield of field.gridColumns">
                            <td>{{childfield.label}}</td>
                            <ng-container *ngIf="previousObject[field.field_name] && previousObject[field.field_name].length > 0 ">
                                <td>{{gridLastData[childfield.field_name]}}</td>
                            </ng-container>
                            <td>{{gridCurrentData[childfield.field_name]}}</td>
                          </tr>
                          </ng-container>
                        </ng-container>
                      </table>
                  </mat-expansion-panel>
                </mat-accordion>
              </td> -->

              
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>